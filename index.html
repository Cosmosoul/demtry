<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    <title>OLOROMBA - é“¾å¼ååº”è¿·å®«</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        /* åŠ è½½ç•Œé¢æ ·å¼ */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-content {
            text-align: center;
            color: #0ff;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(0, 255, 255, 0.3);
            border-top-color: #0ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 20px;
            text-shadow: 0 0 10px #0ff;
        }
        
        /* æ–¹å‘æç¤º */
        #orientation-warning {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            z-index: 9998;
            display: none;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        
        .orientation-content {
            max-width: 300px;
            padding: 30px;
            background: rgba(10, 20, 30, 0.9);
            border-radius: 15px;
            border: 2px solid #0ff;
            box-shadow: 0 0 30px #0ff;
        }
        
        .orientation-content i {
            font-size: 48px;
            margin-bottom: 20px;
            color: #0ff;
        }
        
        .orientation-content h3 {
            margin: 15px 0;
            font-size: 24px;
            color: #0ff;
        }
        
        .orientation-content p {
            margin-bottom: 20px;
            font-size: 16px;
            opacity: 0.8;
            line-height: 1.5;
        }
        
        .orientation-arrow {
            font-size: 40px;
            animation: bounce 1s infinite alternate;
            color: #0ff;
        }
        
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(10px); }
        }
        
        /* æ‰‹æœºç«–å±ä¼˜åŒ–æ ·å¼ */
        @media screen and (max-width: 768px) and (orientation: portrait) {
            .start-container {
                padding: 20px !important;
                margin: 10px !important;
                max-width: 95% !important;
            }
            
            .game-title {
                font-size: 32px !important;
                margin-bottom: 25px !important;
                line-height: 1.2;
            }
            
            .start-buttons {
                gap: 10px !important;
            }
            
            .menu-btn {
                padding: 14px 20px !important;
                font-size: 18px !important;
                min-height: 50px;
            }
            
            .help-container,
            .settings-container {
                padding: 20px !important;
                margin: 10px !important;
                max-height: 85vh !important;
            }
            
            .help-section h3 {
                font-size: 18px !important;
            }
            
            .help-section p {
                font-size: 14px !important;
                line-height: 1.4 !important;
            }
            
            .game-header {
                flex-direction: column !important;
                padding: 10px !important;
                gap: 10px !important;
            }
            
            .level-info {
                width: 100% !important;
                flex-direction: row !important;
                justify-content: space-between !important;
                font-size: 14px !important;
            }
            
            .player-stats {
                width: 100% !important;
                justify-content: space-around !important;
                gap: 15px !important;
            }
            
            .stat {
                font-size: 16px !important;
            }
            
            .stat i {
                font-size: 18px !important;
            }
            
            .score-value {
                font-size: 36px !important;
            }
            
            .grid-container {
                width: 94vw !important;
                height: 94vw !important;
                max-width: 94vw !important;
                max-height: 94vw !important;
                margin: 0 auto;
            }
            
            .instructions {
                font-size: 12px !important;
                padding: 0 10px !important;
                margin-top: 10px !important;
                line-height: 1.4;
            }
            
            .pause-btn,
            .sound-toggle {
                width: 50px !important;
                height: 50px !important;
                font-size: 22px !important;
                bottom: 20px !important;
            }
            
            .pause-btn {
                left: 20px !important;
            }
            
            .sound-toggle {
                right: 20px !important;
            }
            
            /* å¼¹çª—ä¼˜åŒ– */
            .pause-popup,
            .result-popup,
            .shop-popup,
            .fail-popup,
            .completion-popup {
                padding: 20px !important;
                margin: 10px !important;
                max-width: 95% !important;
                max-height: 90vh !important;
                overflow-y: auto !important;
            }
            
            .result-title,
            .fail-title,
            .completion-title {
                font-size: 24px !important;
            }
            
            .stat-row,
            .fail-stat {
                font-size: 16px !important;
                padding: 8px 0 !important;
            }
            
            .shop-items {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }
            
            .shop-item {
                padding: 15px !important;
            }
            
            .shop-item-name {
                font-size: 18px !important;
            }
            
            .shop-controls {
                flex-direction: column !important;
                gap: 10px !important;
            }
            
            .shop-control-btn {
                padding: 12px !important;
                font-size: 16px !important;
                min-height: 50px;
            }
            
            .result-btn,
            .fail-btn,
            .completion-btn,
            .pause-menu-btn {
                padding: 14px 20px !important;
                font-size: 18px !important;
                min-height: 50px;
            }
        }
        
        /* å°å±å¹•è®¾å¤‡é¢å¤–ä¼˜åŒ– */
        @media screen and (max-width: 320px) and (orientation: portrait) {
            .game-title {
                font-size: 28px !important;
            }
            
            .menu-btn {
                font-size: 16px !important;
                padding: 12px 16px !important;
            }
            
            .score-value {
                font-size: 32px !important;
            }
            
            .stat {
                font-size: 14px !important;
            }
        }
        
        /* å¹³æ¿ç«–å±ä¼˜åŒ– */
        @media screen and (min-width: 769px) and (orientation: portrait) {
            .grid-container {
                width: 85vh !important;
                height: 85vh !important;
                max-width: 85vh !important;
                max-height: 85vh !important;
            }
            
            .start-container {
                padding: 30px !important;
            }
            
            .game-title {
                font-size: 40px !important;
            }
        }
    </style>
</head>
<body>
    <!-- åŠ è½½ç•Œé¢ -->
    <div id="loadingScreen" class="active">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">åŠ è½½æ¸¸æˆä¸­...</div>
        </div>
    </div>
    
    <!-- æ–¹å‘æç¤ºï¼ˆæ¨ªå±æ—¶æ˜¾ç¤ºï¼‰ -->
    <div id="orientation-warning">
        <div class="orientation-content">
            <i class="fas fa-mobile-alt"></i>
            <h3>è¯·æ—‹è½¬è®¾å¤‡</h3>
            <p>ä¸ºäº†æœ€ä½³æ¸¸æˆä½“éªŒ<br>è¯·ä½¿ç”¨ç«–å±æ¨¡å¼</p>
            <div class="orientation-arrow">
                <i class="fas fa-arrow-up"></i>
            </div>
        </div>
    </div>
    
    <!-- å¼€å§‹ç•Œé¢ -->
    <div id="startScreen" class="screen">
        <div class="start-container">
            <h1 class="game-title">OLOROMBA</h1>
            <div class="start-buttons">
                <button id="startGameBtn" class="menu-btn">
                    <i class="fas fa-play"></i> å¼€å§‹æ¸¸æˆ
                </button>
                <button id="howToPlayBtn" class="menu-btn">
                    <i class="fas fa-question-circle"></i> ç©æ³•ä»‹ç»
                </button>
                <button id="settingsBtn" class="menu-btn">
                    <i class="fas fa-cog"></i> è®¾ç½®
                </button>
                <button id="exitGameBtn" class="menu-btn">
                    <i class="fas fa-power-off"></i> é€€å‡ºæ¸¸æˆ
                </button>
            </div>
            <div class="version">ç‰ˆæœ¬ 1.0 - æ‰‹æœºä¼˜åŒ–ç‰ˆ</div>
        </div>
    </div>
    
    <!-- å¸®åŠ©ç•Œé¢ -->
    <div id="helpScreen" class="screen">
        <div class="help-container">
            <h2><i class="fas fa-question-circle"></i> æ¸¸æˆç©æ³•</h2>
            <div class="help-content">
                <div class="help-section">
                    <h3><i class="fas fa-crosshairs"></i> åŸºæœ¬è§„åˆ™</h3>
                    <p>1. ç‚¹å‡»æˆ–é•¿æŒ‰ç½‘æ ¼å‘å°„å½©è‰²å¼¹è¯</p>
                    <p>2. å‘å°„å°é¢œè‰² = å¼¹è¯é¢œè‰²</p>
                    <p>3. ç ´åç›¸åŒé¢œè‰²æ–¹å—: +7åˆ†</p>
                    <p>4. ç™½è‰²æ–¹å—å¯åå¼¹æ‰€æœ‰é¢œè‰²å¼¹è¯</p>
                    <p>5. å‡»ä¸­ç»ˆç‚¹æ——å¸œå®Œæˆå…³å¡</p>
                </div>
                <div class="help-section">
                    <h3><i class="fas fa-bomb"></i> ç‰¹æ®Šç‰©å“</h3>
                    <p><span class="bomb-icon">ğŸ’£</span> <strong>ç‚¸å¼¹</strong>: è§¦ç¢°ç«‹å³æŸå¤±1ç‚¹ç”Ÿå‘½</p>
                    <p><span class="chest-icon">ğŸ—ƒï¸</span> <strong>å®ç®±</strong>: è§¦ç¢°è·å¾—200é‡‘å¸</p>
                    <p><span class="flag-icon">ğŸ</span> <strong>ç»ˆç‚¹æ——å¸œ</strong>: è§¦ç¢°å®Œæˆå…³å¡</p>
                </div>
                <div class="help-section">
                    <h3><i class="fas fa-trophy"></i> èƒœåˆ©æ¡ä»¶</h3>
                    <p>1. åœ¨ç”Ÿå‘½å’Œå¼¹è¯è€—å°½å‰åˆ°è¾¾ç»ˆç‚¹</p>
                    <p>2. æ»¡è¶³å…³å¡ç§¯åˆ†è¦æ±‚</p>
                    <p>3. é¿å¼€ç‚¸å¼¹ï¼Œæ”¶é›†å®ç®±</p>
                </div>
                <div class="help-section">
                    <h3><i class="fas fa-mobile-alt"></i> æ‰‹æœºæ“ä½œ</h3>
                    <p>â€¢ ç‚¹å‡»æ–¹å—å‘å°„å¼¹è¯</p>
                    <p>â€¢ é•¿æŒ‰å¯è¿ç»­å‘å°„</p>
                    <p>â€¢ æ‹–æ‹½å¯æ”¹å˜å°„å‡»æ–¹å‘</p>
                    <p>â€¢ ä½¿ç”¨ç«–å±æ¨¡å¼ä½“éªŒæœ€ä½³</p>
                </div>
            </div>
            <button id="backFromHelpBtn" class="back-btn">
                <i class="fas fa-arrow-left"></i> è¿”å›
            </button>
        </div>
    </div>
    
    <!-- è®¾ç½®ç•Œé¢ -->
    <div id="settingsScreen" class="screen">
        <div class="settings-container">
            <h2><i class="fas fa-cog"></i> è®¾ç½®</h2>
            <div class="settings-content">
                <div class="setting-item">
                    <label for="bgmVolume">èƒŒæ™¯éŸ³ä¹éŸ³é‡</label>
                    <div class="volume-control">
                        <i class="fas fa-volume-down"></i>
                        <input type="range" id="bgmVolume" min="0" max="100" value="50">
                        <i class="fas fa-volume-up"></i>
                        <span id="bgmValue">50%</span>
                    </div>
                </div>
                <div class="setting-item">
                    <label for="sfxVolume">éŸ³æ•ˆéŸ³é‡</label>
                    <div class="volume-control">
                        <i class="fas fa-volume-down"></i>
                        <input type="range" id="sfxVolume" min="0" max="100" value="70">
                        <i class="fas fa-volume-up"></i>
                        <span id="sfxValue">70%</span>
                    </div>
                </div>
                <div class="setting-item">
                    <label for="vibration">éœ‡åŠ¨åé¦ˆ</label>
                    <label class="switch">
                        <input type="checkbox" id="vibration" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <label for="particles">ç²’å­æ•ˆæœ</label>
                    <label class="switch">
                        <input type="checkbox" id="particles" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <label for="touchSensitivity">è§¦æ‘¸çµæ•åº¦</label>
                    <div class="volume-control">
                        <i class="fas fa-hand-pointer"></i>
                        <input type="range" id="touchSensitivity" min="1" max="10" value="5">
                        <i class="fas fa-hand-rock"></i>
                        <span id="touchValue">ä¸­</span>
                    </div>
                </div>
            </div>
            <button id="backFromSettingsBtn" class="back-btn">
                <i class="fas fa-arrow-left"></i> è¿”å›
            </button>
        </div>
    </div>
    
    <!-- æ¸¸æˆç•Œé¢ -->
    <div id="gameScreen" class="screen">
        <div class="game-header">
            <div class="level-info">
                <span id="currentLevel">å…³å¡: 1</span>
                <span id="scoreRequirement">ç›®æ ‡: 0åˆ†</span>
            </div>
            <div class="player-stats">
                <div class="stat">
                    <i class="fas fa-heart"></i>
                    <span id="lives">3</span>
                </div>
                <div class="stat">
                    <i class="fas fa-bullseye"></i>
                    <span id="ammo">100</span>
                </div>
                <div class="stat">
                    <i class="fas fa-coins"></i>
                    <span id="money">0</span>
                </div>
            </div>
        </div>
        
        <div class="game-container">
            <div class="score-display">
                <div class="score-value" id="score">0</div>
            </div>
            <div class="grid-container" id="gridContainer">
                <div class="grid" id="grid"></div>
            </div>
            <div class="instructions">
                ç‚¹å‡»æˆ–é•¿æŒ‰å‘å°„ â€¢ å¼¹è¯é¢œè‰²éœ€åŒ¹é…æ–¹å—é¢œè‰² â€¢ æ‰‹æœºå¯æ‹–æ‹½ç„å‡†
            </div>
        </div>
        
        <!-- æš‚åœæŒ‰é’® -->
        <div class="pause-btn" id="pauseBtn">
            <i class="fas fa-pause"></i>
        </div>
        
        <!-- å£°éŸ³æ§åˆ¶æŒ‰é’® -->
        <div class="sound-toggle" id="soundToggle">
            <i class="fas fa-volume-up"></i>
        </div>
        
        <!-- æ‰‹æœºæ“ä½œæç¤º -->
        <div class="mobile-hint" id="mobileHint" style="
            position: absolute;
            bottom: 80px;
            left: 0;
            right: 0;
            text-align: center;
            color: rgba(0, 255, 255, 0.7);
            font-size: 12px;
            padding: 5px;
            display: none;
        ">
            æç¤ºï¼šé•¿æŒ‰å¯è¿ç»­å‘å°„ï¼Œæ‹–æ‹½å¯æ”¹å˜æ–¹å‘
        </div>
    </div>
    
    <!-- æš‚åœèœå• -->
    <div id="pauseMenu" class="overlay">
        <div class="pause-popup">
            <h2>æ¸¸æˆæš‚åœ</h2>
            <div class="pause-buttons">
                <button id="resumeBtn" class="pause-menu-btn">
                    <i class="fas fa-play"></i> ç»§ç»­æ¸¸æˆ
                </button>
                <button id="restartLevelBtn" class="pause-menu-btn">
                    <i class="fas fa-redo"></i> é‡æ–°å¼€å§‹
                </button>
                <button id="quitToMenuBtn" class="pause-menu-btn">
                    <i class="fas fa-home"></i> è¿”å›ä¸»èœå•
                </button>
            </div>
        </div>
    </div>
    
    <!-- ç»“ç®—ç•Œé¢ -->
    <div id="resultScreen" class="overlay">
        <div class="result-popup">
            <div id="resultTitle" class="result-title">ğŸ‰ å…³å¡å®Œæˆï¼ ğŸ‰</div>
            <div class="result-stats">
                <div class="stat-row">
                    <span>è·å¾—ç§¯åˆ†:</span>
                    <span id="resultScore">0</span>
                </div>
                <div class="stat-row">
                    <span>å®ç®±å¥–åŠ±:</span>
                    <span id="chestBonus">+0</span>
                </div>
                <div class="stat-row total">
                    <span>æœ¬å…³æ”¶å…¥:</span>
                    <span id="totalMoney">0</span>
                </div>
                <div class="stat-row requirement">
                    <span>ç§¯åˆ†è¦æ±‚:</span>
                    <span id="requiredScore">0</span>
                </div>
                <div id="requirementStatus" class="status success">
                    <i class="fas fa-check-circle"></i> ç›®æ ‡å·²è¾¾æˆ
                </div>
            </div>
            <button id="continueToShopBtn" class="result-btn">
                å‰å¾€å•†åº— <i class="fas fa-shopping-cart"></i>
            </button>
        </div>
    </div>
    
    <!-- å•†åº—ç•Œé¢ -->
    <div id="shopScreen" class="overlay">
        <div class="shop-popup">
            <div class="shop-header">
                <h2><i class="fas fa-shopping-cart"></i> é“å…·å•†åº—</h2>
                <div class="shop-money">
                    <i class="fas fa-coins"></i> é‡‘å¸: <span id="shopMoney">0</span>
                </div>
            </div>
            
            <div class="shop-items" id="shopItems">
                <!-- é“å…·å°†åŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div class="shop-controls">
                <button id="rerollBtn" class="shop-control-btn">
                    <i class="fas fa-sync-alt"></i> åˆ·æ–°å•†å“ (<span id="rerollCost">150</span>é‡‘å¸)
                </button>
                <button id="skipShopBtn" class="shop-control-btn skip">
                    <i class="fas fa-forward"></i> è·³è¿‡å•†åº—
                </button>
            </div>
            
            <div class="shop-info">
                <p>æ¯å…³åªèƒ½è´­ä¹°ä¸€ä»¶é“å…·ï¼Œæ•ˆæœæŒç»­æ•´å±€æ¸¸æˆ</p>
                <p style="font-size: 12px; margin-top: 5px; opacity: 0.7;">æç¤ºï¼šç‚¹å‡»é“å…·æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</p>
            </div>
        </div>
    </div>
    
    <!-- å¤±è´¥ç•Œé¢ -->
    <div id="failScreen" class="overlay">
        <div class="fail-popup">
            <div class="fail-title">
                <i class="fas fa-skull-crossbones"></i> æ¸¸æˆå¤±è´¥
            </div>
            <div class="fail-stats">
                <div class="fail-stat">
                    <span>æœ€ç»ˆå…³å¡:</span>
                    <span id="failLevel">1</span>
                </div>
                <div class="fail-stat">
                    <span>è·å¾—é‡‘å¸:</span>
                    <span id="failMoney">0</span>
                </div>
                <div class="fail-stat">
                    <span>æœ€é«˜è¿å‡»:</span>
                    <span id="failCombo">0</span>
                </div>
            </div>
            <div id="failReason" class="fail-reason">
                ç”Ÿå‘½å€¼è€—å°½
            </div>
            <button id="backToStartBtn" class="fail-btn">
                <i class="fas fa-home"></i> è¿”å›å¼€å§‹ç•Œé¢
            </button>
        </div>
    </div>
    
    <!-- é€šå…³ç•Œé¢ï¼ˆç¬¬15å…³åï¼‰ -->
    <div id="completionScreen" class="overlay">
        <div class="completion-popup">
            <div class="completion-title">
                <i class="fas fa-trophy"></i> æ­å–œé€šå…³ï¼
            </div>
            <div class="completion-message">
                <p>æ­å–œé€šè¿‡å…¨éƒ¨15ä¸ªå…³å¡ï¼</p>
                <p>ç»§ç»­æ¸¸æˆå°†è¿›å…¥æ— é™æ¨¡å¼ï¼ŒæŒ‘æˆ˜æ›´é«˜çš„éš¾åº¦å’Œç§¯åˆ†ï¼</p>
            </div>
            <div class="completion-buttons">
                <button id="backToMenuCompletionBtn" class="completion-btn">
                    <i class="fas fa-home"></i> å›åˆ°å¼€å§‹ç•Œé¢
                </button>
                <button id="startInfiniteModeBtn" class="completion-btn infinite">
                    <i class="fas fa-infinity"></i> æ— é™æ¨¡å¼
                </button>
            </div>
        </div>
    </div>

    <!-- åŠ è½½è„šæœ¬ -->
    <script src="audio.js"></script>
    <script src="levels.js"></script>
    <script src="shop.js"></script>
    <script src="game.js"></script>
    <script src="ui.js"></script>
    <script src="script.js"></script>
    
    <script>
        // éšè—åŠ è½½ç•Œé¢å¹¶æ˜¾ç¤ºå¼€å§‹ç•Œé¢
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('startScreen').classList.add('active');
                
                // æ£€æµ‹è®¾å¤‡ç±»å‹å¹¶æ˜¾ç¤ºæç¤º
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                if (isMobile) {
                    console.log('ç§»åŠ¨è®¾å¤‡æ£€æµ‹æˆåŠŸ');
                    document.body.classList.add('mobile-device');
                    
                    // æ˜¾ç¤ºæ‰‹æœºæ“ä½œæç¤º
                    const mobileHint = document.getElementById('mobileHint');
                    if (mobileHint) {
                        mobileHint.style.display = 'block';
                        setTimeout(function() {
                            mobileHint.style.display = 'none';
                        }, 5000);
                    }
                }
            }, 1000);
        });
    </script>
</body>
</html>